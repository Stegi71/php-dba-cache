{"name":"PHP DBA Cache","tagline":"Create a caching with the the Database (dbm-style) Abstraction Layer to cache your objects, strings, integers or arrays.","body":"Introduction\r\n============\r\n\r\n    The php-dba-cache uses the database (dbm-style) abstraction layer to cache/store \r\n    your PHP objects, strings, integers or arrays. Even instances of SimpleXMLElement \r\n    can be put to the cache. You dont have to matter about the size of the cache-file.\r\n    It depends on the free space of your disk.\r\n    \r\n\r\nAvailable options\r\n===========================\r\n\r\n    CacheDba\r\n    - Open a given dba database\r\n    - Insert a new record with a given key (persistently or with a given expiration time)\r\n    - Get a record with a given key\r\n    - Replace the value of a record with a given key\r\n    - Delete the record with a given key\r\n    - Return metadata for the given key: expire timestamp & timestamp of last modification time\r\n    - Get all keys from cache\r\n    \r\n    CacheGarbageCollector (optional)\r\n    - Clean all entries\r\n    - Clean expired entries\r\n    - Flush the cache file\r\n    - Optimizes the database file automatically after cleaning process\r\n\r\nInstallation\r\n============\r\n\r\n    \"By using the --enable-dba=shared configuration option you can build a dynamic loadable module\r\n    to enable PHP for basic support of dbm-style databases. You also have to add support for at\r\n    least one of the following handlers by specifying the --with-XXXX configure switch\r\n    to your PHP configure line.\"\r\n    \r\n    More about installation: http://www.php.net/manual/en/dba.installation.php\r\n\r\nDBA handlers\r\n============\r\n\r\n    The behaviour of various aspects for the caching depends on the implementation of yor\r\n    installed dba-type database. I have tested it with several database-handlers like db4, flatfile,\r\n    cdb, cdb_make, gdbm. The cdb & cdb_make family is the fastest, but you have to create\r\n    you own garbage-collection-cleaner or you can delete it manually. Take a look at the tests\r\n    (https://github.com/gjerokrsteski/php-dba-cache/tree/master/tests) to better understand\r\n    how to use the cache.\r\n\r\n    cdb = Tiny Constant Database - for reading\r\n    Cdb is \"a fast, reliable, lightweight package for creating and reading constant databases.\r\n    \" It is from the author of qmail and can be found at http://cr.yp.to/cdb.html. Since it is\r\n    constant, we support only reading operations. And since PHP 4.3.0 we support writing\r\n    (not updating) through the internal cdb library.\r\n\r\n    cdb_make = Tiny Constant Database - for writing\r\n    Since PHP 4.3.0 we support creation of cdb files when the bundled cdb library is used.\r\n\r\n    db4 = Oracle Berkeley DB 4 - for reading and writing\r\n    DB4 is Sleepycat Software's DB4. This is available since PHP 4.3.2.\r\n\r\n    gdbm = GNU Database Manager - for reading and writing\r\n    Gdbm is the GNU database manager.\r\n\r\n    flatfile = default dba extension - for reading and writing\r\n    This is available since PHP 4.3.0 for compatibility with the deprecated dbm extension only\r\n    and should be avoided. However you may use this where files were created in this format.\r\n    That happens when configure could not find any external library.\r\n    \r\n    More about requirements: http://www.php.net/manual/en/dba.requirements.php\r\n\r\n\r\nNice to know\r\n------------\r\n\r\n    Not all of the DBA-style databases can replace key-value pairs, like the CDB. The CDB database\r\n    can handle only with fixed key-value pairs. The best and fastest handlers for DBA-style caching\r\n    are: QDBM, Berkeley DB (DB4), NDBM and least the Flatfile.\r\n    Most problematic are dbm and ndbm which conflict with many installations. The reason for this is\r\n    that on several systems these libraries are part of more than one other library. The configuration\r\n    test only prevents you from configuring malfaunctioning single handlers but not combinations.\r\n\r\nSample for Oracle Berkeley DB 4 with persistent connection\r\n----------------------------------------------------------\r\n\r\n    <?php\r\n\r\n    $cache = new Cache(\r\n      '/your/path/to/the/cahe-file/cache.db4', 'db4'\r\n    );\r\n    \r\n    $yorObject            = new YourObjectYouWantToPutInCache();\r\n    $yourObjectIdentifier = 'md5(get_class($yorObject))';\r\n    \r\n    // Check if your object is in the cache.\r\n    // You also can ignore it, and let the CacheDba do it for you.\r\n    if (false == $cache->has($yourObjectIdentifier)) {\r\n      $cache->delete($yourObjectIdentifier);\r\n    }\r\n    \r\n    $cache->put($yourObjectIdentifier, $yorObject);\r\n    \r\n    // Than somewhere at your project.\r\n    $cache->get($yourObjectIdentifier);\r\n    \r\n    // For the garbage collection you can create an cron-job starting once a day.\r\n    $sweeper = new Sweeper($cache);\r\n    $sweeper->cleanAll();\r\n    \r\n    // or clean all objects older than given expiration since now.\r\n    $sweeper->cleanOld();\r\n    \r\n    ?>\r\n\r\nSaving SimpleXMLElement instances into DB 4 with persistent connection\r\n----------------------------------------------------------------------\r\n\r\n    <?php\r\n    $string = \"<?xml version='1.0'?>\r\n    <document>\r\n     <title>Let us cache</title>\r\n     <from>Joe</from>\r\n     <to>Jane</to>\r\n     <body>Some content here</body>\r\n    </document>\";\r\n\r\n    $simplexml = simplexml_load_string(\r\n        $string,\r\n        'SimpleXMLElement',\r\n        LIBXML_NOERROR|LIBXML_NOWARNING|LIBXML_NONET\r\n    );\r\n\r\n    $identifier = md5('simplexml_identifier');\r\n\r\n    $path = dirname(dirname(__FILE__)).'/tests/_drafts/simple-xml-test-cache.db4';\r\n    $cache = new Cache($path, 'db4');\r\n\r\n    $cache->put($identifier, $simplexml);\r\n\r\n    $getObject = $cache->get($identifier);\r\n\r\n    error_log(' - PUT IN CACHE : '.print_r($simplexml, true));\r\n    error_log(' - GET FROM CACHE : '.print_r($getObject, true));\r\n    error_log(' - IS SAME OBJECT : '.print_r(($simplexml->asXml() === $getObject->asXml())\r\n                                        ? 'true' : 'false', true));\r\n\r\n    ?>\r\n\r\n\r\nBenchmark Test of DBM Brothers\r\n------------------------------\r\n\r\n    This benchmark test is to calculate processing time (real time)\r\n    and file size of database. Writing test is to store 1,000,000 records. Reading test is\r\n    to fetch all of its records. Both of the key and the value of each record are such 8-byte\r\n    strings as `00000001', `00000002', `00000003'... Tuning parameters of each DBM are set to\r\n    display its best performance. Platform: Linux 2.4.31 kernel, EXT2 file system,\r\n    Pentium4 1.7GHz CPU, 1024MB RAM, ThinkPad T42 Compilation: gcc 3.3.2 (using -O3), glibc 2.3.3\r\n\r\n    Result\r\n\r\n    NAME        DESCRIPTION                             WRITE TIME  READ TIME   FILE SIZE\r\n    QDBM        Quick Database Manager 1.8.74           1.89        1.58        55257\r\n    NDBM        New Database Manager 5.1                8.07        7.79        814457\r\n    SDBM        Substitute Database Manager 1.0.2       11.32       0.00        606720\r\n    GDBM        GNU Database Manager 1.8.3              14.01       5.36        82788\r\n    TDB         Trivial Database 1.0.6                  9.64        2.22        51056\r\n    CDB         Tiny Constant Database 0.75             0.87        0.80        39065\r\n    BDB         Berkeley DB 4.4.20                      9.62        5.62        40956\r\n    QDBM-BT-ASC B+ tree API of QDBM (ascending order)   2.37        1.78        24304\r\n    QDBM-BT-RND B+ tree API of QDBM (at random)         10.90       4.82        15362\r\n    BDB-BT-ASC B+ tree API of BDB (ascending order)     3.04        3.06        27520\r\n    BDB-BT-RND B+ tree API of BDB (at random)           10.03       4.15        29120\r\n\r\n    Unit of time is seconds. Unit of size is kilo bytes. Read time of SDBM can not be calculated\r\n    because its database is broken when more than 100000 records.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}